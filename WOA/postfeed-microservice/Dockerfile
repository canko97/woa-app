FROM node:alpine

ARG KEYFILE_CONTENT
ARG MONGODB_CONNECTION_STRING_POSTFEED
ARG ACCESS_TOKEN_PUBLIC_KEY
ARG REFRESH_PUBLIC_KEY

WORKDIR /app

COPY package.json ./

RUN npm install

RUN echo $KEYFILE_CONTENT > ./config/keyfile.json

COPY ./ ./

ENV MONGODB_CONNECTION_STRING_POSTFEED=$MONGODB_CONNECTION_STRING_POSTFEED
ENV ACCESS_TOKEN_PUBLIC_KEY=$ACCESS_TOKEN_PUBLIC_KEY
ENV REFRESH_PUBLIC_KEY=$REFRESH_PUBLIC_KEY

CMD ["npm", "start"]

