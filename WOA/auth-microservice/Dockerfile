FROM node:alpine

ARG ACCESS_TOKEN_PUBLIC_KEY
ARG ACCESS_TOKEN_PRIVATE_KEY
ARG REFRESH_PRIVATE_KEY
ARG REFRESH_PUBLIC_KEY
ARG MONGODB_CONNECTION_STRING_AUTH
ARG GOOGLE_CLIENT_ID
ARG GOOGLE_CLIENT_SECRET

WORKDIR /app

COPY package.json ./

RUN npm install

COPY ./ ./

# Set environment variables
ENV ACCESS_TOKEN_PUBLIC_KEY=$ACCESS_TOKEN_PUBLIC_KEY
ENV ACCESS_TOKEN_PRIVATE_KEY=$ACCESS_TOKEN_PRIVATE_KEY
ENV REFRESH_PRIVATE_KEY=$REFRESH_PRIVATE_KEY
ENV REFRESH_PUBLIC_KEY=$REFRESH_PUBLIC_KEY
ENV MONGODB_CONNECTION_STRING=$MONGODB_CONNECTION_STRING_AUTH
ENV GOOGLE_CLIENT_ID=$GOOGLE_CLIENT_ID
ENV GOOGLE_CLIENT_SECRET=$GOOGLE_CLIENT_SECRET

CMD ["npm", "start"]